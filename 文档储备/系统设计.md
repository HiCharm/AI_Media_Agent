# <center> 智能语音助手 系统设计文档 <center>

## 1. 系统概述

### 1.1 系统名称
智能语音助手 - 学生信息管理系统

### 1.2 系统简介
本系统是一个基于Web的智能语音助手，主要用于学生信息的管理与查询。系统支持语音输入和文字输入两种交互方式，能够识别用户意图并进行相应的信息查询或记录操作。系统集成了AI能力，能够对用户的自然语言进行处理，并提供智能化的响应。

### 1.3 系统目标
- 提供便捷的语音交互界面，支持中文语音识别
- 实现学生信息的高效管理和查询
- 支持批量数据导入功能
- 集成AI能力，提供智能响应
- 提供友好的用户界面和交互体验

## 2. 系统架构

### 2.1 系统整体架构
本系统采用前后端分离的架构设计，具体包括：

- **前端层**：基于HTML5、CSS3和JavaScript实现的单页面应用
- **后端层**：基于Flask框架的Python后端服务
- **数据库层**：SQLite数据库存储系统
- **AI服务层**：集成DeepSeek API提供AI能力

### 2.2 架构流程图
```
用户 --> 前端界面(HTML/CSS/JS)
        |
        v
前端API调用 --> 后端Flask服务
                   |
                   v
                   +--> SQLite数据库
                   |
                   v
                   +--> DeepSeek AI API
```

## 3. 前端设计

### 3.1 技术栈
- HTML5
- CSS3
- JavaScript (原生)
- Font Awesome (图标库)
- Web Speech API (语音识别)

### 3.2 页面结构
- **头部区域**：显示系统标题、状态和数据导入按钮
- **聊天容器**：显示用户与助手的对话内容
- **输入区域**：包括文本输入框、语音输入按钮和发送按钮
- **导入弹窗**：用于批量导入数据

### 3.3 核心功能

#### 3.3.1 消息发送与接收
- 支持文本输入发送
- 支持语音输入发送
- 实时显示对话内容
- 显示输入状态指示器

#### 3.3.2 语音识别
- 利用Web Speech API实现中文语音识别
- 提供语音识别状态反馈
- 支持语音识别错误处理

#### 3.3.3 数据导入
- 支持CSV文件上传导入
- 支持JSON数组直接粘贴导入
- 导入结果展示

#### 3.3.4 用户交互增强
- 提供常用操作建议按钮
- 响应式设计，支持移动端
- 动画效果提升用户体验

## 4. 后端设计

### 4.1 技术栈
- Python 3
- Flask Web框架
- SQLite数据库
- Flask-CORS (跨域支持)
- DeepSeek API (AI服务)

### 4.2 目录结构
```
后端代码/
├── main.py           # 主程序文件
├── document_store.db # SQLite数据库文件
└── README.md         # 后端说明文档
```

### 4.3 核心模块

#### 4.3.1 数据库操作模块
- 数据库初始化
- 文档添加功能
- 文档查询功能

#### 4.3.2 AI代理模块
- 用户意图识别
- 实体提取（如学生姓名）
- AI响应生成

#### 4.3.3 API接口模块
- 聊天接口
- 学生信息查询接口
- 记录添加接口
- 数据导入接口
- 健康检查接口

## 5. 数据库设计

### 5.1 数据库表结构

#### documents表
| 字段名 | 数据类型 | 描述 |
| :--- | :--- | :--- |
| id | INTEGER | 主键，自增 |
| doc_type | TEXT | 文档类型（如student、record） |
| identifier | TEXT | 文档标识符（如学生姓名） |
| data | TEXT | JSON格式的文档内容 |
| created_time | TIMESTAMP | 创建时间，默认当前时间 |

### 5.2 数据模型
- **学生信息**：doc_type="student"，存储学生基本信息
- **记录信息**：doc_type="record"，存储学生相关记录（如请假、表现等）

## 6. API接口设计

### 6.1 聊天接口
- **URL**: `/api/chat`
- **方法**: `POST`
- **请求体**: `{"message": "用户消息内容"}`
- **响应**: `{"status": "success", "response": "助手回复内容"}`
- **功能**: 接收用户消息，分析意图，调用AI生成回复

### 6.2 学生信息查询接口
- **URL**: `/api/students`
- **方法**: `GET`
- **响应**: `{"status": "success", "students": [学生信息列表]}`
- **功能**: 获取所有学生信息

### 6.3 记录添加接口
- **URL**: `/api/record`
- **方法**: `POST`
- **请求体**: `{"student_name": "学生姓名", "record_type": "记录类型", "content": "记录内容"}`
- **响应**: `{"status": "success", "message": "记录已添加"}`
- **功能**: 添加学生相关记录

### 6.4 数据导入接口
- **URL**: `/api/import`
- **方法**: `POST`
- **支持格式**: JSON数组或CSV文件
- **响应**: `{"status": "success", "summary": {"success": 成功数量, "fail": 失败数量}}`
- **功能**: 批量导入数据到系统

### 6.5 健康检查接口
- **URL**: `/api/health`
- **方法**: `GET`
- **响应**: `{"status": "ok", "time": "当前时间"}`
- **功能**: 检查系统运行状态

## 7. 功能模块详解

### 7.1 语音交互模块
- **功能描述**：允许用户通过语音进行交互
- **实现方式**：使用Web Speech API，支持中文语音识别
- **工作流程**：
  1. 用户点击语音按钮
  2. 系统开始录音并进行语音识别
  3. 识别完成后自动发送识别结果
  4. 显示识别状态和结果

### 7.2 意图识别模块
- **功能描述**：分析用户输入，识别用户意图（查询或记录）
- **实现方式**：基于关键词匹配的简单意图识别
- **支持意图**：
  - 查询：包含"查询"、"查找"、"搜索"等关键词
  - 记录：包含"记录"、"添加"、"保存"等关键词

### 7.3 实体提取模块
- **功能描述**：从用户输入中提取关键实体（如学生姓名）
- **实现方式**：基于正则表达式的中文姓名提取
- **使用场景**：用于查询或记录特定学生的信息

### 7.4 数据导入模块
- **功能描述**：支持批量导入数据到系统
- **支持格式**：
  - CSV文件：通过文件上传导入
  - JSON数组：直接粘贴JSON格式数据导入
- **导入流程**：
  1. 用户选择导入方式（CSV文件或JSON）
  2. 系统解析导入数据
  3. 逐条添加到数据库
  4. 返回导入结果统计

## 8. 安全设计

### 8.1 接口安全
- 使用HTTPS协议（生产环境）
- 跨域资源共享（CORS）配置
- 输入数据验证

### 8.2 数据安全
- 敏感数据处理
- 数据库操作异常处理
- 数据备份机制

## 9. 部署方案

### 9.1 开发环境部署
- Python 3.6+
- 安装依赖：`pip install flask flask-cors`
- 启动服务：`python main.py`

### 9.2 生产环境部署
- 使用WSGI服务器（如Gunicorn）
- 配置Nginx作为反向代理
- 环境变量配置（如API密钥）

## 10. 系统扩展

### 10.1 功能扩展
- 支持更多的文档类型
- 增强AI能力，支持更复杂的自然语言处理
- 添加用户认证和权限管理

### 10.2 性能优化
- 数据库索引优化
- 缓存机制引入
- API性能优化

## 11. 总结

智能语音助手系统是一个集成语音识别、自然语言处理和数据管理的综合性应用。系统采用前后端分离架构，具有良好的可扩展性和维护性。通过语音交互和AI能力，为用户提供了便捷、智能的学生信息管理体验。

---

*文档版本：v1.0*  
*更新时间：2024年*
